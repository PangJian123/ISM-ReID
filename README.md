
# HAZY RE-ID: AN INTERFERENCE SUPPRESSION MODEL FOR DOMAIN ADAPTATION PERSON RE-IDENTIFICATION UNDER INCLEMENT WEATHER CONDITION.

This package contains the source code which is associated with the following paper:

Jian Pang, Dacheng Zhang, Huafeng Li, Weifeng Liu, Zhengtao Yu, “HAZY RE-ID: AN INTERFERENCE SUPPRESSION MODEL FOR DOMAIN ADAPTATION PERSON RE-IDENTIFICATION UNDER INCLEMENT WEATHER CONDITION.” accepted as oral on ICME 2021.

Edited by Jian Pang

Usage of this code is free for research purposes only. 

Thank you.

# Requirements:
    CUDA  10.2
    Python  3.8
    Pytorch  1.6.0
    torchvision  0.2.2
    numpy  1.19.0

# Get Started
## 1.Install:
    download the code
    git clone https://github.com/PangJian123/ISM-ReID.git
    cd ISM-ReID
    
## 2.Datasets and the pre-trained 
- Prepare datasets and the pre-trained model please refer to https://github.com/PangJian123/fast-reid
- Download the synthetic hazy datasets  through the links below:
*Hazy-DukeMTMC-reID*:[Baidu Pan](https://pan.baidu.com/s/12engFwDf---c9QSFdyF3eg)（password：7ec8）
*Hazy-Market1501*:[Baidu Pan](https://pan.baidu.com/s/1QFYbfOYgKkLokxXpPHr4uA) （password：xs52）

## 3.Run the training file:
        sh pre_train.sh (Supervised training on source domain)
        sh train.sh (Training ISM)
## Hazy image generation:
- The hazy image is obtained by combining clear image and the corresponding depth map through the method of [hazyimage_generator](https://github.com/phoenixtreesky7/hazyimage_generator).
- The clear image comes from the original dataset(Market-1501 or DukeMTMC-ReID).
- The depth map is generated by [monodepth2](https://github.com/nianticlabs/monodepth2). Note that, we add 'disp = torch.exp(-disp)' after 'disp = outputs[("disp, 0")]' in test_simple.py to obtain reversed depth map.


# Contact:
    Don't hesitate to contact me if you meet any problems when using this code.

    Jian Pang
    Faculty of Information Engineering and Automation
    Kunming University of Science and Technology                                                           
    Email: pangjian@stu.kust.edu.cn

# Acknowledgements
Our code is based on https://github.com/JDAI-CV/fast-reid,https://github.com/nianticlabs/monodepth2 and https://github.com/phoenixtreesky7/hazyimage_generator.
